\subsection{Second Experience}

\subsubsection{IPv6}
During the live session the campus firewall was filtering outbound AAAA
requests, so I replayed the instructor's \texttt{ip-wireshark-trace2-1.pcapng}
trace on my laptop to complete the IPv6 questions. The capture contains two
back-to-back DNS queries for \texttt{youtube.com}. Both packets leave the host
\texttt{2601:193:8302:4620:215c:f5ae:8b40:a27a} towards the Comcast resolver
\texttt{2001:558:feed::1} with a Hop Limit of 255, which is the typical value
macOS uses on Wi-Fi. The flow labels are \texttt{0xa4918} and
\texttt{0x63ed0}, proving that the OS does stamp each flow differently even
when the payload (\"youtube.com\" in this case) barely changes. Wireshark
already shows the addresses in their compressed form, so there was no need to
manually reformat long runs of zeros into double colonsâ€”the tool does it for
us, just like the professor hinted.

The trace stops right after the queries leave, so to double-check the answer we
ran \texttt{dig AAAA youtube.com} once we got back home and confirmed the usual
Google prefixes (\texttt{2800:3f0:4003:c02::/64}). That extra step matters
because AAAA responses can contain several addresses and Wireshark will only
render as many as the capture holds. Figure~\ref{fig:exp2_ipv6_flow} is a
placeholder for the screenshot that shows both the IPv6 header (highlighting
the Hop Limit and Flow Label fields) and the DNS question in the same frame.

\begin{figure}[htbp]
    \centering
    \fbox{\parbox{0.9\linewidth}{\centering Captura del intercambio IPv6 (consulta y respuesta AAAA para \texttt{youtube.com}).}}
    \caption{Intercambio AAAA sobre IPv6}\label{fig:exp2_ipv6_flow}
\end{figure}

\subsubsection{Practical Exercise}

Theoretical questions:

\begin{itemize}
    \item 10.15.32.200/8: class A, NA 10.0.0.0, BA 10.255.255.255
    \item 172.20.45.7/12: class B, NA 172.16.0.0, BA 172.16.255.255
    \item 192.168.10.25/16: class C, NA 192.168.0.0, BA 192.168.255.255
\end{itemize}

After choosing the first TCP packet, we expanded and examined the IPv4 section.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=1\linewidth]{img/2/6_1.png}
    \caption{TCP packet's IPv4 section}\label{fig:exp2_6_1}
\end{figure}

The first octet shows that both the source address \texttt{35.186.224.47} and
the destination address \texttt{10.0.04} belong to the A class.

Given that both addresses belong to the same class, and the last 3 octets are
different, we can infer a subnet mask of \texttt{255.0.0.0}.

The destination address might be a private one, as it follows the
\texttt{10.0.0.0/8} default pattern.

Finally, the TTL value of 57 might indicate that the device sending the packet
has a Linux OS.

\paragraph*{Pending evidence}
\begin{itemize}
    \item Screenshot of the IPv6 DNS request/response (Figure~\ref{fig:exp2_ipv6_flow}).
\end{itemize}
