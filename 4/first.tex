\subsection{First Experience}

\subsubsection{Capturing packets from an execution of traceroute}
For this part, we followed the guide using the provided
\texttt{ip-ethereal-trace-1}. There, it is evident how each probe from
\texttt{traceroute} (from \texttt{192.168.86.61}) is sent with a TTL that
increases one by one, and how the intermediate routers respond with ICMP ``time
exceeded'' messages as the TTL reaches zero. The first three probes die at the
gateway, the next three reach the second hop, and so on until a batch manages
to reach its destination, which is clearly seen by the change of source IP, as
seen in the following figure.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=1\linewidth]{img/1/ethereal.png}
    \caption{Ethereal pcapng}\label{fig:ethereal}
\end{figure}

What is interesting is that, except for the TTL and the checksum, everything
else remains the same in each datagram: same addresses, same size, and same
ICMP identifier.

\subsubsection{Basic IPv4}
Looking at the very first probe in \texttt{ip-ethereal-trace-1} shows how
little metadata traceroute actually needs. The IPv4 header is just the base
20-byte structure (IHL~=~5), the protocol field is set to 1 because this
Windows box uses ICMP echo requests, and the total length hovers around
98~bytes (20 bytes of IPv4, 8 bytes of ICMP, and a short payload that the app
uses as a sequence tag). The source-destination pair is
\texttt{192.168.86.61$\rightarrow$128.119.245.12}. Only a handful of fields
change between successive probes: the TTL (1, then 2, then 3), the checksum
(because TTL is part of it) and the ICMP identifier/sequence pair that
traceroute uses to map each reply back to the correct line in the output.

Everything else stays the same. The DF flag never flips because the tool leaves
fragmentation to routers, the version and header length remain fixed too, and
the destination address never changes. That stability makes it easy to visually
isolate the TTL-induced losses in the packet listâ€”filtering for ICMP and
sorting by time gives a ladder-like pattern where every three red requests are
followed by a green ``TTL~exceeded'' row. Figure~\ref{fig:exp1_ttl_icmp} is a
placeholder for that filtered view so we can add the screenshot right before
turning in the PDF.

\subsubsection{Fragmentation}

This section of the experience was done on a Windows machine, and so we had to
work with the downloaded trace file.

First, we looked for the first IP datagram containing the first part of the
segment sent to the server. After finding it (it wasn't the first packet), we
looked for any field that might indicate that it was fragmented.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=1\linewidth]{img/1/3_1.png}
    \caption{First fragment}\label{fig:exp1_3_1}
\end{figure}

We can see that the flag \textbf{More Fragments} is set, and thus we can
conclude that the packet is indeed fragmented.

We then wanted to know if this packet was the first fragment, or a latter one.
Seeing that the \textbf{fragment offset} value is zero, we can conclude that
this is the first fragment.

The total number of bytes in this datagram (payload plus header) is 1480 plus
20, i.e. 1500, as shown in the previous image.

Moving on to the second fragment, we can see that the fragment offset is no
longer zero. This implies that this fragment is not the first one (which is
true).

\begin{figure}[htbp]
    \centering
    \includegraphics[width=1\linewidth]{img/1/3_2.png}
    \caption{Second fragment}\label{fig:exp1_3_2}
\end{figure}

If we compare the first and second fragments, we can identify the following
differences:

\begin{itemize}
    \item Fragment offset: 0 for first, 1480 for second
    \item Header checksum: different values as the fragment offset is different
\end{itemize}

Finally, we observed the third's fragment information. We immediately notice
that the flag values are different. In this case, the flag \textbf{more
    fragments} is unset, which implies that this is indeed the last fragment.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=1\linewidth]{img/1/3_3.png}
    \caption{Third fragment}\label{fig:exp1_3_3}
\end{figure}

\paragraph*{Pending evidence}
\begin{itemize}
    \item Screenshot of the traceroute executions (Figure~\ref{fig:exp1_traceroute_cli}).
    \item Wireshark capture filtered by \texttt{icmp} (Figure~\ref{fig:exp1_ttl_icmp})
          highlighting the returned hops.
\end{itemize}
